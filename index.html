<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SCFHS Quiz Engine</title>
<style>
  body { font-family: Arial, sans-serif; background: #f4f6f8; padding: 20px; }
  h2 { color: #1a73e8; }
  .question { margin-bottom: 20px; }
  .options button { display: block; margin: 5px 0; padding: 10px 15px; font-size: 16px; cursor: pointer; text-align: left; }
  .correct { background-color: #4CAF50; color: white; }
  .incorrect { background-color: #f44336; color: white; }
  .rationale { margin-top: 15px; padding: 15px; background: #e8f0fe; border-left: 4px solid #1a73e8; display: none; }
  #navigation { margin-top: 20px; }
  #score { font-weight: bold; margin-top: 15px; }
  #jump { margin-top: 15px; }
</style>
</head>
<body>

<h2>SCFHS Quiz Engine</h2>

<div id="quiz">
  <div class="question" id="question-container"></div>
  <div class="rationale" id="rationale"></div>
  
  <div id="navigation">
    <button onclick="prevQuestion()">Previous</button>
    <button onclick="nextQuestion()">Next</button>
  </div>
  
  <div id="jump">
    Jump to question #: <input type="number" id="jumpInput" min="1" style="width:50px">
    <button onclick="jumpToQuestion()">Go</button>
  </div>
  
  <div id="score"></div>
</div>

<script>
// ==== Example SCFHS test items (your exact format) ====
const questions = [
  {
  q: "When the nurse puts the baby with high temperature into cold water, the baby will lose temperature through?",
  options: [
    { text: "Evaporation", tag: "NCLEX" },
    { text: "Convection", tag: "SCFHS" },
    { text: "Conduction", tag: "SAFE_DELAY" },
    { text: "Radiation", tag: "STR" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Heat loss occurs by convection when the body is exposed to moving cooler fluid such as water.\n\n**Why and How:** Convection involves heat transfer through a moving medium (air or liquid) around the body. When the febrile infant is immersed in cold water, the moving water carries heat away from the skin, cooling the body rapidly. This is different from conduction, which requires direct contact with a solid, or evaporation, which involves liquid turning to vapor.",
    distractors: {
      NCLEX: "Evaporation requires liquid to gas conversion such as sweating.",
      SAFE_DELAY: "Conduction requires direct contact with a solid surface.",
      STR: "Radiation involves transfer of heat without contact."
    }
  }
},
{
  q: "When a nurse places a febrile infant into cold water as an emergency intervention, through which mechanism will the infant primarily lose body heat?",
  options: [
    { text: "Evaporation", tag: "SAFE_DELAY" },
    { text: "Convection", tag: "NCLEX" },
    { text: "Conduction", tag: "SCFHS" },
    { text: "Radiation", tag: "STR" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Direct contact between the infant’s body and cold water causes heat loss through conduction.\n\n**Why and How:** Conduction is heat transfer through direct contact. When the infant is in cold water, heat moves from the infant’s warmer body to the colder water, lowering body temperature. Unlike convection, the water does not have to move significantly; contact alone allows energy transfer. Evaporation and radiation are not primary mechanisms in this scenario.",
    distractors: {
      SAFE_DELAY: "Evaporation involves vaporization of liquid, not immersion.",
      NCLEX: "Convection involves heat loss via air or fluid movement, not direct contact.",
      STR: "Radiation involves transfer of heat without physical contact."
    }
  }
},
{
  q: "A patient is admitted to the emergency department after sustaining abdominal injuries and a broken femur from a motor vehicle accident. The patient is pale, diaphoretic, and is not talking coherently. Vital signs upon admission are temperature 98.0 F (36.3 C), heart rate 130 beats/minute, respiratory rate 34 breaths/minute, blood pressure 50/40 mmHg. The healthcare provider suspects which type of shock?",
  options: [
    { text: "Hypovolemic", tag: "SCFHS" },
    { text: "Cardiogenic", tag: "NCLEX" },
    { text: "Distributive", tag: "SAFE_DELAY" },
    { text: "Septic", tag: "STR" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Massive trauma with hypotension, tachycardia, and signs of poor perfusion indicate hypovolemic shock due to blood loss.\n\n**Why and How:** Hypovolemic shock occurs when circulating blood volume drops significantly. Trauma with internal or external bleeding reduces preload, cardiac output, and tissue perfusion, causing tachycardia, hypotension, pallor, and altered mental status. Rapid recognition is essential to initiate fluid resuscitation. Other types of shock are less consistent with acute blood loss in trauma.",
    distractors: {
      NCLEX: "Cardiogenic shock is related to pump failure, not acute trauma.",
      SAFE_DELAY: "Distributive shock involves vasodilation rather than volume loss.",
      STR: "Septic shock develops from infection, not acute injury."
    }
  }
},

];

let currentIndex = 0;
let score = 0;

// ==== Load question ====
function loadQuestion() {
  const container = document.getElementById('question-container');
  const rationale = document.getElementById('rationale');
  rationale.style.display = 'none';
  container.innerHTML = `<p><b>Q${currentIndex + 1}:</b> ${questions[currentIndex].q}</p>`;

  const optionsHtml = questions[currentIndex].options.map((opt, index) => {
    return `<button onclick="checkAnswer(this, '${opt.tag}')">${String.fromCharCode(65 + index)}. ${opt.text} (${opt.tag})</button>`;
  }).join('');
  container.innerHTML += `<div class="options">${optionsHtml}</div>`;

  document.getElementById('score').textContent = `Score: ${score} / ${questions.length}`;
}

// ==== Check answer and show professional analysis ====
function checkAnswer(button, selectedTag) {
  const buttons = button.parentElement.querySelectorAll('button');
  buttons.forEach(b => b.disabled = true);

  const correctTag = questions[currentIndex].correctTag;

  if (selectedTag === correctTag) {
    button.classList.add('correct');
    score++;
  } else {
    button.classList.add('incorrect');
    // Highlight correct answer
    buttons.forEach((b, i) => {
      if (questions[currentIndex].options[i].tag === correctTag) b.classList.add('correct');
    });
  }

  // Show rationale + pathophysiologic why/how for SCFHS
  const rationale = document.getElementById('rationale');
  let rationaleHtml = `<b>Analysis:</b><br>`;
  questions[currentIndex].options.forEach(opt => {
    const symbol = (opt.tag === correctTag) ? "✅" : "❌";
    const analysisText = (opt.tag === correctTag)
      ? questions[currentIndex].analysis?.SCFHS || questions[currentIndex].rationale.correct
      : questions[currentIndex].rationale.distractors[opt.tag];
    rationaleHtml += `${symbol} ${opt.text} (${opt.tag}): ${analysisText}<br><br>`;
  });
  rationale.innerHTML = rationaleHtml;
  rationale.style.display = 'block';

  document.getElementById('score').textContent = `Score: ${score} / ${questions.length}`;
}

// ==== Navigation ====
function nextQuestion() {
  if (currentIndex < questions.length - 1) {
    currentIndex++;
    loadQuestion();
  } else {
    alert(`Quiz complete! Final score: ${score} / ${questions.length}`);
  }
}

function prevQuestion() {
  if (currentIndex > 0) {
    currentIndex--;
    loadQuestion();
  }
}

function jumpToQuestion() {
  const qNum = parseInt(document.getElementById('jumpInput').value);
  if (!isNaN(qNum) && qNum >= 1 && qNum <= questions.length) {
    currentIndex = qNum - 1;
    loadQuestion();
  } else {
    alert(`Enter a valid question number between 1 and ${questions.length}`);
  }
}

// ==== Initialize quiz ====
loadQuestion();
</script>

</body>
</html>
