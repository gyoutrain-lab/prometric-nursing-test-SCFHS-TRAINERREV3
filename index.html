<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SCFHS Quiz Engine</title>
<style>
  body { font-family: Arial, sans-serif; background: #f4f6f8; padding: 20px; }
  h2 { color: #1a73e8; }
  .question { margin-bottom: 20px; }
  .options button { display: block; margin: 5px 0; padding: 10px 15px; font-size: 16px; cursor: pointer; text-align: left; }
  .correct { background-color: #4CAF50; color: white; }
  .incorrect { background-color: #f44336; color: white; }
  .rationale { margin-top: 15px; padding: 15px; background: #e8f0fe; border-left: 4px solid #1a73e8; display: none; }
  #navigation { margin-top: 20px; }
  #score { font-weight: bold; margin-top: 15px; }
  #jump { margin-top: 15px; }
</style>
</head>
<body>

<h2>SCFHS Quiz Engine</h2>

<div id="quiz">
  <div class="question" id="question-container"></div>
  <div class="rationale" id="rationale"></div>
  
  <div id="navigation">
    <button onclick="prevQuestion()">Previous</button>
    <button onclick="nextQuestion()">Next</button>
  </div>
  
  <div id="jump">
    Jump to question #: <input type="number" id="jumpInput" min="1" style="width:50px">
    <button onclick="jumpToQuestion()">Go</button>
  </div>
  
  <div id="score"></div>
</div>

<script>
// ==== Example SCFHS test items (your exact format) ====
const questions = [
  {
    q: "Which action BEST prevents catheter-associated urinary tract infections?",
    options: [
      { text: "Removing the catheter as soon as possible", tag: "SCFHS" },
      { text: "Irrigating the catheter daily", tag: "SAFE_DELAY" },
      { text: "Using antiseptic solution for cleansing", tag: "NCLEX" },
      { text: "Changing drainage bags frequently", tag: "STR" }
    ],
    correctTag: "SCFHS",
    rationale: {
      correct: "Early removal is the most effective prevention strategy.",
      distractors: {
        SAFE_DELAY: "Routine irrigation increases infection risk.",
        NCLEX: "Soap and water are sufficient.",
        STR: "Frequent bag changes are unnecessary."
      }
    },
    analysis: {
      SCFHS: "Catheter-associated urinary tract infections occur because bacteria ascend along the catheter into the bladder. Removing the catheter early reduces exposure time, prevents biofilm formation, and decreases risk of bacterial colonization. This preserves normal host defenses, prevents inflammatory response in the urinary tract, and lowers risk of sepsis."
    }
  },
  {
    q: "A client with diabetes reports shakiness, sweating, and confusion. What is the nurse’s PRIORITY action?",
    options: [
      { text: "Check blood glucose level", tag: "SCFHS" },
      { text: "Administer insulin", tag: "NCLEX" },
      { text: "Encourage exercise", tag: "SAFE_DELAY" },
      { text: "Notify the physician", tag: "STR" }
    ],
    correctTag: "SCFHS",
    rationale: {
      correct: "Symptoms suggest hypoglycemia and require immediate glucose assessment.",
      distractors: {
        NCLEX: "Insulin would worsen hypoglycemia.",
        SAFE_DELAY: "Exercise lowers glucose further.",
        STR: "Assessment comes before notification."
      }
    },
    analysis: {
      SCFHS: "Hypoglycemia occurs due to excess insulin or insufficient carbohydrate intake. Low blood glucose stimulates the autonomic nervous system causing shakiness, sweating, and tachycardia. CNS symptoms include confusion. Immediate glucose assessment allows rapid correction to prevent seizures, coma, or death."
    }
  }
  // Inject remaining 98+ test items here
];

let currentIndex = 0;
let score = 0;

// ==== Load question ====
function loadQuestion() {
  const container = document.getElementById('question-container');
  const rationale = document.getElementById('rationale');
  rationale.style.display = 'none';
  container.innerHTML = `<p><b>Q${currentIndex + 1}:</b> ${questions[currentIndex].q}</p>`;

  const optionsHtml = questions[currentIndex].options.map((opt, index) => {
    return `<button onclick="checkAnswer(this, '${opt.tag}')">${String.fromCharCode(65 + index)}. ${opt.text} (${opt.tag})</button>`;
  }).join('');
  container.innerHTML += `<div class="options">${optionsHtml}</div>`;

  document.getElementById('score').textContent = `Score: ${score} / ${questions.length}`;
}

// ==== Check answer and show professional analysis ====
function checkAnswer(button, selectedTag) {
  const buttons = button.parentElement.querySelectorAll('button');
  buttons.forEach(b => b.disabled = true);

  const correctTag = questions[currentIndex].correctTag;

  if (selectedTag === correctTag) {
    button.classList.add('correct');
    score++;
  } else {
    button.classList.add('incorrect');
    // Highlight correct answer
    buttons.forEach((b, i) => {
      if (questions[currentIndex].options[i].tag === correctTag) b.classList.add('correct');
    });
  }

  // Show rationale + pathophysiologic why/how for SCFHS
  const rationale = document.getElementById('rationale');
  let rationaleHtml = `<b>Analysis:</b><br>`;
  questions[currentIndex].options.forEach(opt => {
    const symbol = (opt.tag === correctTag) ? "✅" : "❌";
    const analysisText = (opt.tag === correctTag)
      ? questions[currentIndex].analysis?.SCFHS || questions[currentIndex].rationale.correct
      : questions[currentIndex].rationale.distractors[opt.tag];
    rationaleHtml += `${symbol} ${opt.text} (${opt.tag}): ${analysisText}<br><br>`;
  });
  rationale.innerHTML = rationaleHtml;
  rationale.style.display = 'block';

  document.getElementById('score').textContent = `Score: ${score} / ${questions.length}`;
}

// ==== Navigation ====
function nextQuestion() {
  if (currentIndex < questions.length - 1) {
    currentIndex++;
    loadQuestion();
  } else {
    alert(`Quiz complete! Final score: ${score} / ${questions.length}`);
  }
}

function prevQuestion() {
  if (currentIndex > 0) {
    currentIndex--;
    loadQuestion();
  }
}

function jumpToQuestion() {
  const qNum = parseInt(document.getElementById('jumpInput').value);
  if (!isNaN(qNum) && qNum >= 1 && qNum <= questions.length) {
    currentIndex = qNum - 1;
    loadQuestion();
  } else {
    alert(`Enter a valid question number between 1 and ${questions.length}`);
  }
}

// ==== Initialize quiz ====
loadQuestion();
</script>

</body>
</html>
